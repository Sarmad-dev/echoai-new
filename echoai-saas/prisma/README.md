# Database Setup Guide

This guide will help you set up the Supabase database for the EchoAI SaaS application.

## Prerequisites

1. Create a Supabase account at [supabase.com](https://supabase.com)
2. Create a new Supabase project

## Setup Steps

### 1. Enable pgvector Extension

In your Supabase project dashboard:
1. Go to the SQL Editor
2. Run the script from `../scripts/setup-supabase.sql`
3. Or manually run: `CREATE EXTENSION IF NOT EXISTS vector;`

### 2. Configure Environment Variables

1. Copy `.env.example` to `.env`
2. Update the following variables with your Supabase project details:
   - `DATABASE_URL`: Your Supabase PostgreSQL connection string
   - `NEXT_PUBLIC_SUPABASE_URL`: Your Supabase project URL
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`: Your Supabase anon key
   - `SUPABASE_SERVICE_ROLE_KEY`: Your Supabase service role key

### 3. Push Database Schema

Run the following command to create the database tables:

```bash
npx prisma db push
```

### 4. Generate Prisma Client

If not already done, generate the Prisma client:

```bash
npx prisma generate
```

## Database Schema

The database includes the following models:

- **User**: Stores user account information and API keys
- **UserSettings**: Stores chatbot customization settings
- **Document**: Stores processed documents with vector embeddings
- **Conversation**: Stores chat conversations
- **Message**: Stores individual chat messages with sentiment analysis

## Vector Storage

The `Document` model includes a `vector(1536)` field for storing embeddings generated by the text-embedding-3-small model. This enables semantic search capabilities for the RAG pipeline.

## Development Commands

- `npx prisma studio`: Open Prisma Studio to view/edit data
- `npx prisma db push`: Push schema changes to database
- `npx prisma generate`: Regenerate Prisma client
- `npx prisma migrate dev`: Create and apply migrations (for production)